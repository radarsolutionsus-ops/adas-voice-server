<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Submit Vehicle - ADAS F1RST</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/css/apple-style.css">
</head>
<body>
  <header class="app-header">
    <div class="app-logo">ADAS F1RST</div>
    <div class="header-center">
      <span class="shop-badge" id="shopName">Loading...</span>
    </div>
    <div class="header-actions">
      <button class="header-btn" id="helpBtn" title="Help">
        <span class="icon" id="helpIcon"></span>
      </button>
      <button class="btn-logout" id="logoutBtn">
        <span class="icon icon-sm" id="logoutIcon"></span>
        Sign Out
      </button>
    </div>
  </header>

  <main class="app-main">
    <a href="/shop/dashboard.html" class="back-link">
      <span class="icon" id="backIcon"></span>
      Back to Dashboard
    </a>

    <div class="card form-card">
      <div class="form-header">
        <h1>Submit New Vehicle</h1>
        <p class="text-secondary">Upload your estimate and we'll extract the vehicle details</p>
      </div>

      <!-- Progress Steps -->
      <div class="form-steps">
        <div class="step active" data-step="1">
          <div class="step-number">1</div>
          <div class="step-label">Basic Info</div>
        </div>
        <div class="step-line"></div>
        <div class="step" data-step="2">
          <div class="step-number">2</div>
          <div class="step-label">Documents</div>
        </div>
        <div class="step-line"></div>
        <div class="step" data-step="3">
          <div class="step-number">3</div>
          <div class="step-label">Review</div>
        </div>
      </div>

      <form id="submitForm">
        <!-- Step 1: Basic Info -->
        <div class="form-step active" id="step1">
          <div class="form-group">
            <label class="form-label">RO/PO Number <span class="required">*</span></label>
            <input type="text" id="roPo" class="form-input" placeholder="Enter RO or PO number" required>
            <p class="form-hint">This is your shop's work order number</p>
          </div>

          <div class="form-group">
            <label class="form-label">Vehicle (Optional)</label>
            <input type="text" id="vehicleDesc" class="form-input" placeholder="e.g., 2024 Toyota Camry - we'll extract from estimate">
            <p class="form-hint">Leave blank if unsure - we'll get it from the estimate</p>
          </div>

          <div class="form-group">
            <label class="form-label">Notes (Optional)</label>
            <textarea id="notes" class="form-textarea" rows="3" placeholder="Any special instructions or notes..."></textarea>
          </div>

          <div class="form-actions form-actions-between">
            <div></div>
            <button type="button" class="btn-accent" onclick="goToStep(2)">
              Continue to Documents
              <span class="icon icon-sm" id="nextIcon1"></span>
            </button>
          </div>
        </div>

        <!-- Step 2: Documents -->
        <div class="form-step" id="step2">
          <div class="form-group">
            <label class="form-label">Estimate PDF <span class="required">*</span></label>
            <div class="file-upload" id="estimateUpload">
              <input type="file" id="estimateFile" accept=".pdf">
              <div class="upload-content" id="estimateContent">
                <span class="icon upload-icon" id="uploadIcon1"></span>
                <p class="upload-text">Click or drag to upload estimate</p>
                <p class="upload-hint">PDF format, max 10MB</p>
              </div>
            </div>
            <p class="form-hint">We'll extract VIN and vehicle info from the estimate</p>
          </div>

          <div class="form-group">
            <label class="form-label">Pre-Scan Report (Optional)</label>
            <div class="file-upload" id="prescanUpload">
              <input type="file" id="prescanFile" accept=".pdf">
              <div class="upload-content" id="prescanContent">
                <span class="icon upload-icon" id="uploadIcon2"></span>
                <p class="upload-text">Click or drag to upload pre-scan</p>
                <p class="upload-hint">PDF format, max 10MB</p>
              </div>
            </div>

            <div class="checkbox-group">
              <label class="checkbox-label">
                <input type="checkbox" id="noDtcConfirm">
                <span class="checkbox-text">No pre-scan available - I confirm no active DTCs</span>
              </label>
            </div>
          </div>

          <div class="form-actions form-actions-between">
            <button type="button" class="btn-secondary" onclick="goToStep(1)">
              <span class="icon icon-sm" id="backIcon2"></span>
              Back
            </button>
            <button type="button" class="btn-accent" onclick="processDocuments()">
              Process Documents
              <span class="icon icon-sm" id="nextIcon2"></span>
            </button>
          </div>
        </div>

        <!-- Step 3: Review -->
        <div class="form-step" id="step3">
          <div class="review-section">
            <h3>Extracted Information</h3>
            <p class="text-secondary">Please verify the information below</p>

            <div class="review-grid">
              <div class="review-item">
                <span class="review-label">RO/PO</span>
                <span class="review-value" id="reviewRoPo">-</span>
              </div>
              <div class="review-item">
                <span class="review-label">VIN</span>
                <span class="review-value" id="reviewVin">-</span>
              </div>
              <div class="review-item">
                <span class="review-label">Vehicle</span>
                <span class="review-value" id="reviewVehicle">-</span>
              </div>
              <div class="review-item">
                <span class="review-label">Estimate</span>
                <span class="review-value success" id="reviewEstimate">Uploaded</span>
              </div>
              <div class="review-item">
                <span class="review-label">Pre-Scan</span>
                <span class="review-value" id="reviewPrescan">-</span>
              </div>
            </div>

            <div class="review-notes" id="reviewNotesSection" style="display:none;">
              <span class="review-label">Notes</span>
              <p class="review-value" id="reviewNotes">-</p>
            </div>
          </div>

          <div class="info-banner">
            <span class="icon" id="infoBannerIcon"></span>
            <p>After submission, we'll process the estimate and determine calibration requirements. You'll be notified when ready to schedule.</p>
          </div>

          <div class="form-actions" style="flex-direction:column;gap:12px;">
            <button type="submit" class="btn-accent btn-large btn-full" id="submitBtn">
              <span class="icon" id="submitIcon"></span>
              Submit Vehicle
            </button>
            <button type="button" class="btn-ghost btn-full" onclick="goToStep(1)">
              <span class="icon icon-sm" id="editIcon"></span>
              Edit Information
            </button>
          </div>
        </div>
      </form>

      <!-- Processing Overlay -->
      <div class="processing-overlay" id="processingOverlay" style="display:none;">
        <div class="processing-content">
          <div class="spinner"></div>
          <p id="processingText">Processing documents...</p>
        </div>
      </div>
    </div>
  </main>

  <!-- Help Modal -->
  <div class="modal-overlay" id="helpModal">
    <div class="modal">
      <div class="modal-header">
        <h3>Need Help?</h3>
        <button class="modal-close" id="helpModalClose">
          <span class="icon icon-sm" id="closeIcon"></span>
        </button>
      </div>
      <div class="modal-body">
        <div class="help-item">
          <span class="icon" id="helpPhoneIcon"></span>
          <div class="help-item-content">
            <strong>Call Us</strong>
            <p><a href="tel:+13055551234">305-555-1234</a></p>
          </div>
        </div>
        <div class="help-item">
          <span class="icon" id="helpMailIcon"></span>
          <div class="help-item-content">
            <strong>Email Support</strong>
            <p><a href="mailto:adasf1rstservice@gmail.com">adasf1rstservice@gmail.com</a></p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Success Modal -->
  <div class="modal-overlay" id="successModal">
    <div class="modal">
      <div class="modal-success">
        <span class="icon" id="successIcon"></span>
        <h2>Vehicle Submitted!</h2>
        <p>Your vehicle has been submitted successfully. We'll be in touch shortly.</p>
        <a href="/shop/dashboard.html" class="btn-accent btn-large">Back to Dashboard</a>
      </div>
    </div>
  </div>

  <script src="/js/icons.js"></script>
  <script src="/js/auth.js"></script>
  <script src="/js/api.js"></script>
  <script src="/shop/js/shop-common.js"></script>
  <script src="/shop/js/submit.js"></script>
</body>
</html>
